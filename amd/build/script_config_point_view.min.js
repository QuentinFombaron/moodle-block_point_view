define(["jquery","core/ajax","core/notification"],function(a,b,c){function d(a,d,e,f,g){a.click(function(a){M.util.show_confirm_dialog(a,{message:M.util.get_string(d,"block_point_view"),callback:function(){b.call([{methodname:"block_point_view_"+e,args:f,done:g,fail:c.exception}])}})})}return{init:function(b,e){var f,g,h,i;f=a("#id_config_enable_point_views"),g=a("#id_config_enable_difficultytracks"),(h=function(){var b=f.val()>0,c=g.val()>0;a("#id_activities_header").toggle(b||c),a(".reactions, #id_images_header").toggle(b),a(".difficultytracks").toggle(c)})(),f.change(h),g.change(h),i=function(b){var c=a(".cb"+b+":checkbox"),d=c.filter(":checked").length;a("#enableall"+b).toggleClass("active",d===c.length),a("#disableall"+b).toggleClass("active",0===d)},a(".enablemodulereactions").change(function(){i(a(this).data("type")),i(a(this).data("section"))}),a(".enable-disable button").each(function(){var b=a(this).data("type")||a(this).data("section");i(b),a(this).click(function(){a(".cb"+b+":checkbox").prop("checked",a(this).data("enable")).change()})}),a(".moduletrackselect select").change(function(){a("#track_"+a(this).data("id")).css({"background-color":e[a(this).val()]})}).change(),d(a("#delete_custom_pix"),"deleteemojiconfirmation","delete_custom_pix",{contextid:b.contextid,courseid:b.courseid,draftitemid:a('input[name="config_point_views_pix"]').val()},function(){a('.pix-preview[data-source="custom"], #delete_custom_pix').remove(),document.querySelector("#fitem_id_config_point_views_pix .fp-path-folder-name").click()}),a("[name=config_pixselect]").change(function(){var b=a(this).val();a("img.currentpix").each(function(){var c=a('img[data-source="'+b+'"][data-reaction="'+a(this).data("reaction")+'"]');1==c.length&&c.attr("src")>""&&a(this).attr("src",c.attr("src"))})}),d(a("#reset_reactions"),"resetreactionsconfirmation","update_db",{func:"reset",courseid:b.courseid},function(){c.alert(M.util.get_string("info","moodle"),M.util.get_string("reactionsresetsuccessfully","block_point_view"),M.util.get_string("ok","moodle"))})}}});